ã€<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Battle Ã  la carte â€“ å®‰å…¨ç‰ˆï¼ˆCPUæˆ¦ï¼‰v0.3.1</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700;800&display=swap" rel="stylesheet">
<style>
  :root{--bg:#0b0f19;--ink:#eef2ff;--mut:#a1a8b5;--line:#ffffff1a;--card:#11162a;--pri:#f59e0b}
  *{box-sizing:border-box}body{margin:0;font-family:"Noto Sans JP",system-ui;color:var(--ink);background:#0b0f19}
  .wrap{max-width:1080px;margin:0 auto;padding:16px}
  .top{display:flex;gap:8px;align-items:center;justify-content:space-between;flex-wrap:wrap}
  .btn{padding:10px 14px;border-radius:12px;border:1px solid #ffffff30;background:#ffffff14;color:var(--ink);font-weight:700}
  .btn.primary{background:linear-gradient(135deg,#f59e0b,#ef4444);border:none}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  @media (max-width:900px){.row{grid-template-columns:1fr}}
  .area{border:1px solid #ffffff1a;border-radius:16px;padding:12px;background:#0f1425}
  .who{display:flex;align-items:center;justify-content:space-between}
  .hand,.set{display:flex;gap:8px;flex-wrap:wrap}
  .back{width:96px;height:68px;border:1px solid #ffffff2a;border-radius:10px;display:grid;place-items:center;background:#0c1220}
  .card{min-width:140px;max-width:180px;padding:10px;border:1px solid #ffffff20;border-radius:14px;background:#101630}
  .card .name{font-weight:800}.mut{color:var(--mut)}.hr{height:1px;background:#ffffff1a;margin:8px 0}
  .log{height:220px;overflow:auto;background:#0c1220;border:1px dashed #ffffff2a;border-radius:12px;padding:8px;font-size:14px}
  .tags{display:flex;gap:6px;flex-wrap:wrap}.tag{padding:4px 8px;border:1px solid #ffffff25;border-radius:999px;font-size:12px}
  .tag.on{background:#10b98133;border-color:#10b981aa}
  .modal{position:fixed;inset:0;background:#0008;display:none;align-items:center;justify-content:center;padding:16px;z-index:99}
  .sheet{max-width:740px;width:100%;background:#0f142a;border:1px solid #ffffff22;border-radius:16px;padding:12px}
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:8px}
  .choice{border:1px solid #ffffff25;border-radius:12px;padding:8px;background:#101630}
  .choice.sel{outline:2px solid #f59e0b}
</style>
</head>
<body>

<!-- â‘  è‡ªå‹•ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆï¼ˆbodyç›´å¾Œã«é…ç½®æ¸ˆã¿ï¼‰ -->
<script>
(function(){
  var basePath = '/aniani-playground/';
  if (location.hostname.endsWith('github.io') &&
      location.pathname.indexOf(basePath) === -1) {
    location.replace('https://donadonaa24-cyber.github.io' + basePath + 'game.html?redir=' + Date.now());
  }
})();
</script>

<div class="wrap">
  <div class="top">
    <h1 style="margin:0">ğŸ³ Battle Ã  la carte â€“ å®‰å…¨ç‰ˆï¼ˆCPUæˆ¦ï¼‰</h1>
    <div style="display:flex;gap:6px;flex-wrap:wrap">
      <button type="button" class="btn" id="btnCraft">å½¹ã‚’ä½œã‚‹</button>
      <button type="button" class="btn" id="btnBuy">åŠ å·¥ã‚«ãƒ¼ãƒ‰</button>
      <button type="button" class="btn" id="btnEnd">ã‚¿ãƒ¼ãƒ³çµ‚äº†</button>
      <!-- â‘¡ ãƒ‹ãƒ¥ãƒ¼ã‚²ãƒ¼ãƒ ï¼ˆçµ¶å¯¾URLã§å¼·åˆ¶ãƒªãƒ­ãƒ¼ãƒ‰ï¼‰ -->
      <button class="btn primary" id="btnNew"
        onclick="location.href='https://donadonaa24-cyber.github.io/aniani-playground/game.html?ts='+Date.now()">
        ãƒ‹ãƒ¥ãƒ¼ã‚²ãƒ¼ãƒ 
      </button>
      <a class="btn" href="index.html">â† ãƒ›ãƒ¼ãƒ </a>
    </div>
  </div>

  <div class="area">
    <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap">
      <div>å±±æœ­ <b id="deckCount">0</b> / ã‚´ãƒŸç®± <b id="trashCount">0</b></div>
      <div class="mut">ã‚¿ãƒ¼ãƒ³ï¼š<b id="turnCount">-</b>ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆï¼š<span id="evtRest">-</span>ï¼‰</div>
      <div class="mut">å…ˆæ‰‹ã‚¤ãƒ™ãƒ³ãƒˆåˆ¶é™ï¼š<b id="eventLock">-</b></div>
    </div>
  </div>

  <div class="row">
    <section class="area">
      <div class="who"><h3>ğŸ¤– CPU</h3><div class="mut">æ‰‹æœ­ <b id="cpuHand">0</b> / ã‚»ãƒƒãƒˆ <b id="cpuSet">0</b> / å¾—ç‚¹ <b id="cpuScore">0</b></div></div>
      <div class="tags" id="cpuProcs"></div>
      <div class="mut">â€»æ‰‹æœ­éå…¬é–‹ãƒ»ã‚»ãƒƒãƒˆã¯è£</div>
      <div class="set" id="cpuSetCards"></div>
    </section>
    <section class="area">
      <div class="who"><h3>ğŸ§‘ ã‚ãªãŸ</h3><div class="mut">æ‰‹æœ­ <b id="youHand">0</b> / ã‚»ãƒƒãƒˆ <b id="youSet">0</b> / å¾—ç‚¹ <b id="youScore">0</b></div></div>
      <div class="tags" id="youProcs"></div>
      <h4>æ‰‹æœ­</h4>
      <div class="hand" id="yourHandCards"></div>
      <div class="hr"></div>
      <h4>ã‚»ãƒƒãƒˆï¼ˆè£å‘ãï¼‰</h4>
      <div class="set" id="yourSetCards"></div>
      <div class="mut">ã‚»ãƒƒãƒˆä¸Šé™2ï¼ˆå†·å‡åº«ã§3ï¼‰ã€‚ã‚¤ãƒ™ãƒ³ãƒˆä»¥å¤–ã§äº¤æ›ä¸å¯ã€‚</div>
    </section>
  </div>

  <section class="area">
    <h3 style="margin:0 0 6px 0;">ãƒ­ã‚°</h3>
    <div id="logContent" class="log"></div>
  </section>
</div>

<!-- å½¹ã¥ãã‚Š -->
<div class="modal" id="modalCraft">
  <div class="sheet">
    <h3 style="margin:0 0 6px 0">å½¹ã‚’ä½œã‚‹</h3>
    <div class="grid" id="craftList"></div>
    <div class="hr"></div>
    <button class="btn" id="closeCraft">é–‰ã˜ã‚‹</button>
  </div>
</div>

<!-- åŠ å·¥ -->
<div class="modal" id="modalBuy">
  <div class="sheet">
    <h3 style="margin:0 0 6px 0">åŠ å·¥ã‚«ãƒ¼ãƒ‰ï¼ˆå„3ç‚¹ï¼‰</h3>
    <div class="grid" id="buyList"></div>
    <div class="hr"></div>
    <button class="btn" id="closeBuy">é–‰ã˜ã‚‹</button>
  </div>
</div>

<!-- 2æšæ®‹ã— -->
<div class="modal" id="modalKeep">
  <div class="sheet">
    <h3 style="margin:0 0 6px 0">æ‰‹æœ­2æšã ã‘æ®‹ã™ï¼ˆã‚¿ãƒƒãƒ—ã—ã¦é¸æŠâ†’æ±ºå®šï¼‰</h3>
    <div class="grid" id="keepList"></div>
    <div class="hr"></div>
    <button class="btn primary" id="confirmKeep">æ±ºå®š</button>
  </div>
</div>

<!-- ã‚²ãƒ¼ãƒ æœ¬ä½“JS -->
<script src="game.js"></script>

<!-- â‘¢ è¨ºæ–­ï¼†èµ·å‹•ï¼ˆbodyã®æœ€å¾Œï¼‰ -->
<div id="diag"
     style="position:fixed;left:8px;bottom:8px;font:12px/1.2 system-ui;color:#fff;
            background:#000a;padding:6px 8px;border-radius:8px;z-index:9999">
  loadingâ€¦
</div>
<script>
  // ç”»é¢ä¸‹ã®è¨ºæ–­è¡¨ç¤ºã‚’æ›¸ãæ›ãˆã‚‹é–¢æ•°ï¼ˆãã®ã¾ã¾ã§OKï¼‰
  function setDiag(t){
    var el = document.getElementById('diag');
    if (el) el.textContent = String(t);
  }

  // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã¯ã€ŒUIã®é…ç·šã€ã ã‘ã€‚ã‚²ãƒ¼ãƒ ã¯é–‹å§‹ã—ãªã„ï¼
  document.addEventListener('DOMContentLoaded', function(){
    setDiag('æº–å‚™OKã€‚ãƒ‹ãƒ¥ãƒ¼ã‚²ãƒ¼ãƒ ã‚’æŠ¼ã—ã¦é–‹å§‹ï¼');
    try {
      // ãƒœã‚¿ãƒ³ç­‰ã®ã‚¤ãƒ™ãƒ³ãƒˆã ã‘çµç·š
      if (typeof wireUI === 'function') { wireUI(); }

      // ã‚‚ã— URL ã« ?autostart=1 ãŒä»˜ã„ã¦ã„ãŸã‚‰è‡ªå‹•é–‹å§‹ï¼ˆé–‹ç™ºç”¨ï¼‰
      const url = new URL(location.href);
      if (url.searchParams.get('autostart') === '1') {
        newGame();
        setDiag('è‡ªå‹•é–‹å§‹ã—ã¾ã—ãŸï¼ˆautostart=1ï¼‰');
      }
    } catch (e) {
      setDiag('åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼: ' + e);
      alert('åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼: ' + e);
    }
  });

  // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼šæ—§ç’°å¢ƒå‘ã‘ã€‚è‡ªå‹•é–‹å§‹ã¯ã—ãªã„ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã ã‘å‡ºã™
  setTimeout(function(){
    var d = document.getElementById('diag');
    if (d && /loading/i.test(d.textContent)) {
      setDiag('æº–å‚™ã§ãã¾ã—ãŸã€‚ãƒ‹ãƒ¥ãƒ¼ã‚²ãƒ¼ãƒ ã§é–‹å§‹ã—ã¦ã­ï¼');
    }
  }, 1200);

</script>
<script src="./game.js?v=3"></script>
</body>
</html>